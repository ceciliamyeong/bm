<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KRW Rolling 24h Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5"></script>

  <style>
    :root{
      --bg:#f8fafc;
      --panel:#ffffff;
      --border:#e5e7eb;
      --text:#0f172a;
      --muted:#64748b;

      --shadow:0 1px 2px rgba(15,23,42,.06);
      --radius:14px;

      --accent:#2563eb;
      --accent-2:#7c3aed;

      --sidebar:#0b1220;
      --sidebarText:#e2e8f0;
      --sidebarMuted:#94a3b8;

      --chip:#f1f5f9;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
    }

    /* Layout */
    .app{
      display:grid;
      grid-template-columns: 260px 1fr;
      min-height:100vh;
    }
    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
    }

    /* Sidebar */
    .sidebar{
      background:var(--sidebar);
      padding:18px 14px;
      position:sticky;
      top:0;
      height:100vh;
      overflow:auto;
      border-right:1px solid rgba(255,255,255,.06);
    }
    @media (max-width: 980px){
      .sidebar{
        position:relative;
        height:auto;
      }
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 10px 14px;
      border-bottom:1px solid rgba(255,255,255,.08);
      margin-bottom:14px;
    }
    .logo{
      width:32px; height:32px;
      border-radius:10px;
      background:linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow:0 6px 18px rgba(37,99,235,.25);
    }
    .brand h1{
      margin:0;
      font-size:14px;
      color:var(--sidebarText);
      letter-spacing:-0.2px;
    }
    .brand p{
      margin:2px 0 0;
      font-size:12px;
      color:var(--sidebarMuted);
    }

    .navsec{
      margin:14px 0;
    }
    .navtitle{
      font-size:11px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:rgba(226,232,240,.7);
      padding:0 10px;
      margin:0 0 8px;
    }
    .nav a{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 10px;
      border-radius:10px;
      color:var(--sidebarText);
      text-decoration:none;
      font-size:13px;
      transition: background .15s ease;
    }
    .nav a:hover{ background:rgba(255,255,255,.06); }
    .nav a .tag{
      font-size:11px;
      color:var(--sidebarMuted);
      background:rgba(255,255,255,.06);
      padding:2px 8px;
      border-radius:999px;
      white-space:nowrap;
    }

    /* Main */
    .main{
      padding:18px 18px 34px;
    }
    .topbar{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    .topbar .title h2{
      margin:0;
      font-size:20px;
      letter-spacing:-0.3px;
    }
    .topbar .title p{
      margin:6px 0 0;
      font-size:13px;
      color:var(--muted);
      max-width:820px;
      line-height:1.45;
    }
    .topbar .meta{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .chip{
      background:var(--chip);
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      color:#334155;
      white-space:nowrap;
    }
    .chip b{ font-weight:700; }

    /* Cards / widgets */
    .panel{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }

    .kpiGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      margin-bottom:14px;
    }
    @media (min-width: 980px){
      .kpiGrid{ grid-template-columns: repeat(4, 1fr); }
    }
    .kpi{
      padding:12px 12px;
      min-width:0;
    }
    .kpi .label{ color:var(--muted); font-size:12px; margin:0 0 6px; }
    .kpi .value{ font-size:20px; font-weight:800; letter-spacing:-0.3px; margin:0; }
    .kpi .note{ color:var(--muted); font-size:12px; margin-top:6px; }

    /* Section header */
    .section{
      margin-top:16px;
    }
    .sectionHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      margin:0 0 10px;
    }
    .sectionHead h3{
      margin:0;
      font-size:14px;
      letter-spacing:-0.2px;
    }
    .sectionHead p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }
    .sectionHead .right{
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    /* Widget grid (The Block-like) */
    .widgets{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    @media (min-width: 1100px){
      .widgets{ grid-template-columns: repeat(2, 1fr); }
    }

    .widget{
      padding:12px;
    }
    .widgetHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .wTitle{
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .wIcon{
      width:28px; height:28px;
      border-radius:10px;
      background:#eef2ff;
      border:1px solid #e0e7ff;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#3730a3;
      font-weight:800;
      font-size:12px;
      flex:0 0 auto;
    }
    .wTitle h4{
      margin:0;
      font-size:13px;
      letter-spacing:-0.2px;
    }
    .wTitle .desc{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }
    .wMeta{
      text-align:right;
      color:var(--muted);
      font-size:11px;
      white-space:nowrap;
    }

    /* Chart areas */
    .chart{
      width:100%;
      height:320px;
    }
    #totalChart{ height:360px; }
    #treemap{ height:360px; }
    #stableChart{ height:220px; }

    /* Controls */
    .toolbar{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    .btn{
      border:1px solid var(--border);
      background:#fff;
      color:#334155;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      cursor:pointer;
    }
    .btn.active{
      border-color:#0f172a;
      color:#0f172a;
      font-weight:800;
    }

    /* Lists */
    .list{ margin:0; padding:0; list-style:none; }
    .list li{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:9px 2px;
      border-top:1px solid var(--border);
      font-size:12.5px;
      color:#0f172a;
    }
    .list li:first-child{ border-top:none; }
    .pill{
      font-size:11px;
      color:#334155;
      background:var(--chip);
      border:1px solid var(--border);
      padding:3px 8px;
      border-radius:999px;
      white-space:nowrap;
    }
    .footnote{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }
    code{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>

<body>
<div class="app">

  <!-- LEFT SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>KRW Market Board</h1>
        <p>Rolling 24h · 8h snapshot</p>
      </div>
    </div>

    <div class="navsec">
      <div class="navtitle">Markets</div>
      <nav class="nav">
        <a href="#sec-overview">Overview <span class="tag">KRW</span></a>
        <a href="#sec-flows">Flows & Share <span class="tag">EX</span></a>
        <a href="#sec-concentration">Concentration <span class="tag">Top10</span></a>
        <a href="#sec-stables">Stablecoins <span class="tag">K-Safety</span></a>
      </nav>
    </div>

    <div class="navsec">
      <div class="navtitle">K-Intelligence</div>
      <nav class="nav">
        <a href="#sec-topcoins">Top Coins <span class="tag">Heat</span></a>
        <a href="#sec-extop">Exchange Top5 <span class="tag">Up/BT/CO</span></a>
        <a href="#sec-kimchi">Smart Kimchi <span class="tag">Premium</span></a>
      </nav>
    </div>

    <div class="navsec">
      <div class="navtitle">Data</div>
      <nav class="nav">
        <a href="#sec-data">Paths <span class="tag">JSON</span></a>
      </nav>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">

    <div class="topbar">
      <div class="title">
        <h2>KRW Rolling 24h Dashboard</h2>
        <p>“최근 24시간(rolling) 거래대금”을 8시간마다 갱신해 한국 KRW 시장의 현재 판(테마/쏠림/거래소 이동)을 한 페이지에서 확인합니다.</p>
      </div>
      <div class="meta">
        <span class="chip" id="metaUpdated">UPDATED: -</span>
        <span class="chip" id="metaSignal">SIGNAL: -</span>
      </div>
    </div>

    <!-- KPI -->
    <section id="sec-overview" class="kpiGrid">
      <div class="panel kpi">
        <p class="label">현재(최근 24h) 총 거래대금</p>
        <p class="value" id="kpiTotal">-</p>
        <div class="note" id="kpiTs">-</div>
      </div>
      <div class="panel kpi">
        <p class="label">Top10 쏠림 (최근 24h)</p>
        <p class="value" id="kpiTop10">-</p>
        <div class="note" id="kpiTop10Note">-</div>
      </div>
      <div class="panel kpi">
        <p class="label">거래소 구도 (최근 24h)</p>
        <p class="value" id="kpiEx">-</p>
        <div class="note" id="kpiExNote">-</div>
      </div>
      <div class="panel kpi" style="border-color:#bfdbfe;">
        <p class="label" style="color:#1d4ed8;">K-Safety (Stablecoin Share)</p>
        <p class="value" id="kpiStable">-</p>
        <div class="note" id="kpiStableNote">-</div>
      </div>
    </section>

    <!-- TOTAL (big) -->
    <section class="section" id="sec-flows">
      <div class="sectionHead">
        <div>
          <h3>Flow</h3>
          <p>총 거래대금 수준(라인) + 직전 대비 변화(막대)로 “시장 온도”를 봅니다.</p>
          <div class="toolbar">
            <button class="btn" id="btn1d">1D</button>
            <button class="btn active" id="btn3d">3D</button>
            <button class="btn" id="btn7d">7D</button>
            <span class="pill">rolling 24h · overlaps ok</span>
          </div>
        </div>
        <div class="right">Snapshot cadence: 8h</div>
      </div>

      <div class="panel widget">
        <div class="widgetHead">
          <div class="wTitle">
            <div class="wIcon">Σ</div>
            <div>
              <h4>총 거래대금 추이 (Rolling 24h)</h4>
              <div class="desc">Step line(수준) + Δ bar(직전 대비) 조합</div>
            </div>
          </div>
          <div class="wMeta" id="wTotalMeta">UPDATED: -</div>
        </div>
        <div id="totalChart" class="chart"></div>
      </div>

      <!-- share + top10 vs rest : ✅ “아래 나란히 / 덜 좁게” -->
      <div class="widgets" style="margin-top:12px;">
        <div class="panel widget" id="sec-concentration">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">%</div>
              <div>
                <h4>거래소 점유율(%) 추이</h4>
                <div class="desc">업비트·빗썸·코인원 비중 이동</div>
              </div>
            </div>
            <div class="wMeta">SOURCE: internal</div>
          </div>
          <div id="shareChart" class="chart"></div>
        </div>

        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">10</div>
              <div>
                <h4>Top10 vs Rest (쏠림/확산)</h4>
                <div class="desc">Top10/Rest 분해 + Top10 점유율 라인</div>
              </div>
            </div>
            <div class="wMeta">SOURCE: internal</div>
          </div>
          <div id="topRestChart" class="chart"></div>
        </div>
      </div>
    </section>

    <!-- Right-side style blocks: Top coins, stable, exchange top, kimchi -->
    <section class="section" id="sec-topcoins">
      <div class="sectionHead">
        <div>
          <h3>Top Coins</h3>
          <p>“어떤 알트에 쏠렸는지”를 한 눈에 확인합니다.</p>
        </div>
        <div class="right">
          <span class="pill" id="pillNow">-</span>
          <span class="pill" id="pillSignal">-</span>
        </div>
      </div>

      <div class="widgets">
        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">T</div>
              <div>
                <h4>Top10 Treemap</h4>
                <div class="desc">규모(거래대금) 기준 시각화</div>
              </div>
            </div>
            <div class="wMeta">VIEW: 24h</div>
          </div>
          <div id="treemap" class="chart"></div>

          <ul class="list" id="top10List" style="margin-top:8px;"></ul>
        </div>

        <div class="panel widget" id="sec-stables">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">S</div>
              <div>
                <h4>Stable Dominance</h4>
                <div class="desc">KRW 시장 “안전선호/대기자금” 신호</div>
              </div>
            </div>
            <div class="wMeta">K-Safety</div>
          </div>
          <div id="stableChart" class="chart"></div>

          <div class="footnote">
            KPI의 <b>K-Safety</b>와 동일한 데이터(스테이블 거래대금/비중) 기반입니다.
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="sec-extop">
      <div class="sectionHead">
        <div>
          <h3>Exchange Top5</h3>
          <p>거래소별로 “채널 쏠림(상위 코인)”을 따로 봅니다.</p>
        </div>
        <div class="right">Upbit · Bithumb · Coinone</div>
      </div>

      <div class="widgets">
        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">U</div>
              <div>
                <h4>Upbit Top5</h4>
                <div class="desc">최근 24h 거래대금 기준</div>
              </div>
            </div>
            <div class="wMeta">KRW pairs</div>
          </div>
          <ul class="list" id="upTop5"></ul>
        </div>

        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">B</div>
              <div>
                <h4>Bithumb Top5</h4>
                <div class="desc">최근 24h 거래대금 기준</div>
              </div>
            </div>
            <div class="wMeta">KRW pairs</div>
          </div>
          <ul class="list" id="btTop5"></ul>
        </div>
      </div>

      <div class="panel widget" style="margin-top:12px;">
        <div class="widgetHead">
          <div class="wTitle">
            <div class="wIcon">C</div>
            <div>
              <h4>Coinone Top5</h4>
              <div class="desc">최근 24h 거래대금 기준</div>
            </div>
          </div>
          <div class="wMeta">KRW pairs</div>
        </div>
        <ul class="list" id="coTop5"></ul>
      </div>
    </section>

    <section class="section" id="sec-kimchi">
      <div class="sectionHead">
        <div>
          <h3>Smart Kimchi</h3>
          <p>BTC/ETH 김프 추이 + Kimchi Type/Score로 “지금 김프의 성격”을 봅니다.</p>
        </div>
        <div class="right" id="kimchiUpdated">UPDATED: -</div>
      </div>

      <div class="widgets">
        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">%</div>
              <div>
                <h4>Kimchi Premium % (BTC/ETH/Combo)</h4>
                <div class="desc">국내(Upbit KRW) vs 글로벌(USD) * 환산</div>
              </div>
            </div>
            <div class="wMeta">v1</div>
          </div>
          <div id="kimchiPremChart" class="chart"></div>
        </div>

        <div class="panel widget">
          <div class="widgetHead">
            <div class="wTitle">
              <div class="wIcon">K</div>
              <div>
                <h4>Kimchi Type & Score</h4>
                <div class="desc">Retail/Constraint/Neutral 분류 + score</div>
              </div>
            </div>
            <div class="wMeta">v1</div>
          </div>
          <div id="kimchiScoreChart" class="chart"></div>

          <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;">
            <span class="pill" id="kimchiTypePill">-</span>
            <span class="pill" id="kimchiScorePill">-</span>
            <span class="pill" id="kimchiPremPill">-</span>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="sec-data">
      <div class="panel widget">
        <div class="widgetHead">
          <div class="wTitle">
            <div class="wIcon">JS</div>
            <div>
              <h4>Data Paths</h4>
              <div class="desc">GitHub Pages에서 읽는 JSON 경로</div>
            </div>
          </div>
          <div class="wMeta">/bm/out/history/</div>
        </div>
        <div class="footnote">
          KRW: <code>/bm/out/history/krw_24h_latest.json</code> · <code>/bm/out/history/krw_24h_snapshots.json</code><br/>
          Kimchi: <code>/bm/out/history/kimchi_latest.json</code> · <code>/bm/out/history/kimchi_snapshots.json</code>
        </div>
      </div>
    </section>

  </main>
</div>

<script>
  /* =========================================================
     ✅ 너의 기존 JS( refreshData / render / ECharts setOption )
     여기 그대로 붙여넣으면 됨.
     - 주의: init에서 kimchiPremChart, kimchiScoreChart도 echarts.init 해줘야 함
     - metaUpdated / metaSignal / wTotalMeta / kimchiUpdated 같은 텍스트도 너의 데이터로 세팅해주면 끝
     ========================================================= */

  // 아래는 "빈 껍데기" 방지용 최소 유틸만 두고,
  // 너의 기존 코드로 전부 교체/붙여넣기 추천.

  function num(x){ const n = Number(x); return Number.isFinite(n) ? n : 0; }
</script>

</body>
</html>
